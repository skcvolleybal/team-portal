on:
  workflow_dispatch:
  push: 
    branches: 
      - dev
name: ðŸš€ Deploy Team-Portal to test
jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest
    steps:
      - name: ðŸšš Get latest code
        - uses: actions/checkout@v2
      # - uses: actions/setup-node@master
      # - name: ðŸ—ï¸ Installing NPM dependencies
      #   run: npm i -f
      # - name: ðŸ”¨ Building Angular
      #   run: npm run build
      # - name: ðŸ—ï¸ Installing PHP dependencies
      #   run: composer update --ignore-platform-reqs --working-dir=php
      # - name: rsync deployments
      #   uses: burnett01/rsync-deployments@5.2.1
      #   with:
      #     switches: -avzr --delete
      #     path: ./  
      #     remote_path: public_html/test/public_html/team-portal/
      #     remote_host: ${{ secrets.REMOTE_HOST }}
      #     remote_user: ${{ secrets.REMOTE_USER }}
      #     remote_key: ${{ secrets.PRIVATE_KEY }}
      - name: Check Antagonist SSH
        - if: always()
        - run: echo "Did the previous job (Rsync) fail? Make sure you've whitelisted the current GitHub Runners IP in Antagonist SSH key. Go to https://skcvolleybal.nl:2223/user/plugins/ssh and add the following IP address to the 'Github Runner Key Antagonist --> "
      - name: ðŸ”Ž Show Github Runner IP
        if: always()
        run: curl https://api.ipify.org
      # - name: ðŸ“‚ Sync files
      #   uses: SamKirkland/FTP-Deploy-Action@4.3.3
      #   with:
      #     server: ftp.skcvolleybal.nl
      #     username: ${{ secrets.test_ftp_username }}
      #     password: ${{ secrets.test_ftp_password }}
        # Server-dir not necessary: the FTP account only has rights to write in test/public_html/team-portal. See webhost control panel for FTP. 